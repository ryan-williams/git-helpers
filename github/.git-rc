
defn pgr parse-github-url
defn hb hub browse
defn hpr hub pr
defn hprq hub pull-request

defn ghds github-docs-snapshot
defn ghdss github-docs-snapshot -s

defn hds github-docs-snapshot
defn hdss github-docs-snapshot -s

defn gha "gh api"
defn ghj 'gh api -H "Accept: application/vnd.github+json"'
defn ghw github-workflows.py

defn ghow gh repo view --web
github_open_web_branch() {
    gh repo view --web -b "$(git current-branch)"
}
export -f github_open_web_branch
defn ghob github_open_web_branch

defn ghr gh run
defn ghrh gh run --help
defn ghrl gh run list
defn ghrlh gh run list --help
defn ghrv gh run view
defn ghrvh gh run view --help
defn ghrvj gh run view --job
defn ghrvw gh run view --web
gh_run_view_jobs() {
    gh run view "$@" --json jobs
}
export -f gh_run_view_jobs
defn ghrvjs gh_run_view_jobs
defn ghrvl gh run view --log
defn ghrvlj gh run view --log --job
gh_run_view_url() {
    ghrv "$@" --json url | jr .url
}
export -f gh_run_view_url
defn ghrvu gh_run_view_url
gh_run_open() {
    url="$(gh_run_view_url "$@")"
    open "$url"
}
export -f gh_run_open
defn ghro gh_run_open

gh_last_workflow_run() {
    gh run list -L 1 --json databaseId | jq -r .[0].databaseId
}
export -f gh_last_workflow_run
defn ghlw gh_last_workflow_run
defn ghlwr gh_last_workflow_run

gh_workflow_run() {
    name="${1%.yml}"; shift
    gh workflow run $name.yml "$@"
}
export -f gh_workflow_run
defn ghwr gh_workflow_run
gh_workflow_run_current_branch() {
    name="${1%.yml}"; shift
    gh workflow run $name.yml --ref "$(git current-branch)" "$@"
}
export -f gh_workflow_run_current_branch
defn ghwrc gh_workflow_run_current_branch

defn ghwl gh workflow list

gh_run_list_in_progress() {
    gh run list -s in_progress "$@"
}
export -f gh_run_list_in_progress
defn ghwip gh_run_list_in_progress

gh_open_last() {
    run="$(gh_last_workflow_run)"
    gh run view --web $run
}
export -f gh_open_last
defn ghol gh_open_last
